(window.webpackJsonp=window.webpackJsonp||[]).push([[292],{495:function(s,t,a){"use strict";a.r(t);var e=a(5),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"守护进程-cmd-powershell"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#守护进程-cmd-powershell"}},[s._v("#")]),s._v(" 守护进程|cmd|powershell")]),s._v(" "),a("p",[s._v("cmd 版本，5秒检查一次")]),s._v(" "),a("div",{staticClass:"language-cmd extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('@echo off\n:start\nchoice /t 5 /d y /n >nul     \n\necho "======================="\ndate /T \nnetstat -ano | find  "0.0.0.0:8080"\necho errorlevel= %errorlevel%\nif %errorlevel%==0 (   \necho "yes port is listening"\n\n(for  /f "tokens=5"  %%i in (\n\'netstat -ano ^| find  "0.0.0.0:8080"\'\n) do  set TestProcessPID=%%i)\n\necho  TestProcessPID= %TestProcessPID%\n\n(\n\ttasklist | find "%TestProcessPID%" | find "java.exe"\n\tif %errorlevel%==0 (\n\n\t\techo "yes is a java process"\n\t)else(\n\n\t\techo "process is in used"\n\t)\n)\n\n) else (  \necho "No"\n\n这里执行启动命令\n)\ngoto start\n\n')])])]),a("p",[s._v("powershell")]),s._v(" "),a("div",{staticClass:"language-powershell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$testProgramName")]),s._v("="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"frpc.exe"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$testProgramPort")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7000"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$array")]),s._v(" = @"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("netstat "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ano "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" find `"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('":'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$testProgramPort")]),s._v('`")\n'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$isFrpcRuning")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("$false")]),s._v("\nif ("),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$array")]),s._v(".Count -ge 1){\n    foreach("),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$item")]),s._v(" in "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$array")]),s._v("){\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$items")]),s._v(" = @("),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$item")]),s._v(' -split "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('")\n        '),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$frpcPid")]),s._v(" = "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$items")]),s._v("[-1]\n        Write-Output "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$frpcPid")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$frpcProcessName")]),s._v(' = (@(tasklist | find `"'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$frpcPid")]),s._v('`") -split "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('")[0]\n        #Write-Output '),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$frpcProcessName")]),s._v("\n        if("),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$frpcProcessName")]),s._v(" -eq "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$testProgramName")]),s._v("){\n            "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$isFrpcRuning")]),s._v("="),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("$true")]),s._v("\n        }else{\n            Stop-Process -Force -Id "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$frpcPid")]),s._v("\n        }\n    }\n\n}\nif(!"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$isFrpcRuning")]),s._v('){\n    Start-Process -WindowStyle Hidden  -FilePath  "')]),s._v("F:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("Program Files"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("Java"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("jdk1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("0_202"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exe"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" -ArgumentList "')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("jar "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Xmx1024M "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Xms256M  F:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("www"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("wwwroot"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("test"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("1"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("SNAPSHOT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("jar "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("port=7035"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" \n}else{\n    Write-Output "')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$testProgramName")]),s._v(" is running!"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n \n")])])]),a("p",[s._v("cmd上没有类似于linux上的"),a("code",[s._v("&")]),s._v("，让进程可以在关闭窗口后继续运行，而powershell可以通过命令行让进程继续运行在后后台即使命令行窗口关闭了。")])])}),[],!1,null,null,null);t.default=r.exports}}]);